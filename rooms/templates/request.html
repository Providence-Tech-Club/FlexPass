{% extends 'base.html' %}

{% block title %}Submit Request{% endblock %}

{% block content %}
<div class="card bg-base-300 w-96 shadow-md mt-5">
<div class="card-body">
<form method="post">
    {% csrf_token %}

    <h2 class="card-title text-2xl mb-2">Request for<strong>{{ room.name }}</strong></h2>

    <div class="form-group mt-3">
        <label class="text-base">{{ form.reason_choice.label_tag }}</label>
        {% for choice in form.reason_choice %}
        <div>
        <input class="radio m-2"
            {{ choice.tag }}
            <label for="{{ choice.id_for_label }}">{{ choice.choice_label }}</label>
        </div>
        {% endfor %}
    </div>

    <div class="form-group other-reason-container input my-2" style="display: none;">
        {{ form.other_reason.label_tag }}
        {{ form.other_reason }}
        {% if form.other_reason.errors %}
        <div class="error">{{ form.other_reason.errors }}</div>
        {% endif %}
    </div>

    <div class="form-group mt-3">
        <label class="text-base">{{ form.round_trip.label_tag }}</label>
        {% for choice in form.round_trip %}
        <div>
        <input class="radio m-2"
            {{ choice.tag }}
            <label for="{{ choice.id_for_label }}">{{ choice.choice_label }}</label>
        </div>
        {% endfor %}
    </div>

    <div class="divider my-2"></div>

    <div class="card-actions justify-end">
        <button class="btn btn-primary" type="submit">Submit Request</button>
    </div>
</form>
</div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const reasonRadios = document.querySelectorAll('input[name="reason_choice"]');
        const otherContainer = document.querySelector('.other-reason-container');

        function toggleOtherField() {
            const selectedValue = document.querySelector('input[name="reason_choice"]:checked').value;
            otherContainer.style.display = selectedValue === 'Other' ? 'flex' : 'none';

            // Make other_reason required only when "other" is selected
            const otherInput = document.querySelector('#id_other_reason');
            otherInput.required = selectedValue === 'Other';
        }

        // Add event listeners to all radio buttons
        reasonRadios.forEach(radio => {
            radio.addEventListener('change', toggleOtherField);
        });

        // Initial check
        toggleOtherField();
    });
</script>
{% endblock %}
